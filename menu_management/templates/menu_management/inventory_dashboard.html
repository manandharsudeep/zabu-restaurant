{% extends 'base.html' %}

{% block title %}Inventory Management - Zabu Restaurant{% endblock %}

{% block extra_css %}
<style>
    .inventory-header {
        background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        color: white;
        padding: 2rem 0;
        margin-bottom: 2rem;
    }
    
    .stat-card {
        background: white;
        border-radius: 15px;
        padding: 1.5rem;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        border-left: 4px solid;
        transition: transform 0.3s ease;
    }
    
    .stat-card:hover {
        transform: translateY(-5px);
    }
    
    .stat-card.total-items {
        border-left-color: #007bff;
    }
    
    .stat-card.low-stock {
        border-left-color: #ffc107;
    }
    
    .stat-card.expiring {
        border-left-color: #dc3545;
    }
    
    .stat-card.total-value {
        border-left-color: #28a745;
    }
    
    .stat-number {
        font-size: 2.5rem;
        font-weight: bold;
        margin-bottom: 0.5rem;
    }
    
    .stat-label {
        color: #6c757d;
        font-size: 0.9rem;
        text-transform: uppercase;
        letter-spacing: 1px;
    }
    
    .alert-card {
        background: white;
        border-radius: 10px;
        padding: 1rem;
        margin-bottom: 1rem;
        border-left: 4px solid;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .alert-card.critical {
        border-left-color: #dc3545;
        background: #fff5f5;
    }
    
    .alert-card.high {
        border-left-color: #ffc107;
        background: #fffbf0;
    }
    
    .alert-card.medium {
        border-left-color: #17a2b8;
        background: #f0fcff;
    }
    
    .alert-title {
        font-weight: 600;
        margin-bottom: 0.25rem;
    }
    
    .alert-description {
        color: #6c757d;
        font-size: 0.9rem;
    }
    
    .transaction-item {
        background: white;
        border-radius: 8px;
        padding: 1rem;
        margin-bottom: 0.5rem;
        border-left: 3px solid #e9ecef;
        transition: all 0.3s ease;
    }
    
    .transaction-item:hover {
        border-left-color: #007bff;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    .transaction-type {
        display: inline-block;
        padding: 0.25rem 0.75rem;
        border-radius: 15px;
        font-size: 0.8rem;
        font-weight: 600;
        margin-bottom: 0.5rem;
    }
    
    .transaction-type.receive {
        background: #d4edda;
        color: #155724;
    }
    
    .transaction-type.issue {
        background: #f8d7da;
        color: #721c24;
    }
    
    .transaction-type.waste {
        background: #fff3cd;
        color: #856404;
    }
    
    .transaction-type.adjustment {
        background: #d1ecf1;
        color: #0c5460;
    }
    
    .quick-actions {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
        margin-bottom: 2rem;
    }
    
    .action-btn {
        background: white;
        border: 2px solid #e9ecef;
        border-radius: 10px;
        padding: 1.5rem;
        text-align: center;
        text-decoration: none;
        color: #495057;
        transition: all 0.3s ease;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 0.5rem;
    }
    
    .action-btn:hover {
        border-color: #007bff;
        color: #007bff;
        transform: translateY(-3px);
        box-shadow: 0 4px 15px rgba(0,123,255,0.2);
    }
    
    .action-icon {
        font-size: 2rem;
    }
    
    .action-title {
        font-weight: 600;
    }
    
    @media (max-width: 768px) {
        .quick-actions {
            grid-template-columns: 1fr;
        }
        
        .stat-card {
            margin-bottom: 1rem;
        }
    }
</style>
{% endblock %}

{% block content %}
<!-- Inventory Header -->
<div class="inventory-header">
    <div class="container">
        <h1 class="display-4">üì¶ Inventory Management</h1>
        <p class="lead">Real-time inventory tracking, purchasing, and cost control</p>
    </div>
</div>

<div class="container">
    <!-- Quick Actions -->
    <div class="quick-actions">
        <a href="{% url 'menu_management:inventory_items' %}" class="action-btn">
            <div class="action-icon">üìã</div>
            <div class="action-title">Inventory Items</div>
            <small>Manage inventory catalog</small>
        </a>
        
        <a href="{% url 'menu_management:create_vendor' %}" class="action-btn">
            <div class="action-icon">üè¢</div>
            <div class="action-title">New Vendor</div>
            <small>Add supplier/vendor</small>
        </a>
        
        <a href="{% url 'menu_management:inventory_transactions' %}" class="action-btn">
            <div class="action-icon">üîÑ</div>
            <div class="action-title">Transactions</div>
            <small>View inventory movements</small>
        </a>
        
        <a href="{% url 'menu_management:purchase_orders' %}" class="action-btn">
            <div class="action-icon">üìÑ</div>
            <div class="action-title">Purchase Orders</div>
            <small>Manage purchasing</small>
        </a>
        
        <a href="{% url 'menu_management:waste_tracking' %}" class="action-btn">
            <div class="action-icon">üóëÔ∏è</div>
            <div class="action-title">Waste Tracking</div>
            <small>Track spoilage and waste</small>
        </a>
        
        <a href="{% url 'menu_management:inventory_reports' %}" class="action-btn">
            <div class="action-icon">üìä</div>
            <div class="action-title">Reports</div>
            <small>Analytics and insights</small>
        </a>
    </div>
    
    <!-- Statistics Cards -->
    <div class="row mb-4">
        <div class="col-md-3 col-sm-6 mb-3">
            <div class="stat-card total-items">
                <div class="stat-number">{{ total_items }}</div>
                <div class="stat-label">Total Items</div>
            </div>
        </div>
        
        <div class="col-md-3 col-sm-6 mb-3">
            <div class="stat-card low-stock">
                <div class="stat-number">{{ low_stock_items }}</div>
                <div class="stat-label">Low Stock Items</div>
            </div>
        </div>
        
        <div class="col-md-3 col-sm-6 mb-3">
            <div class="stat-card expiring">
                <div class="stat-number">{{ expiring_soon }}</div>
                <div class="stat-label">Expiring Soon</div>
            </div>
        </div>
        
        <div class="col-md-3 col-sm-6 mb-3">
            <div class="stat-card total-value">
                <div class="stat-number">${{ total_inventory_value|default:"0"|floatformat:0 }}</div>
                <div class="stat-label">Total Value</div>
            </div>
        </div>
    </div>
    
    <div class="row">
        <!-- Critical Alerts -->
        <div class="col-lg-6 mb-4">
            <h3>üö® Critical Alerts</h3>
            <div class="alert-section">
                {% if critical_alerts %}
                    {% for alert in critical_alerts %}
                        <div class="alert-card {{ alert.priority }}">
                            <div class="alert-title">
                                {% if alert.type == 'low_stock' %}
                                    üì¶ Low Stock: {{ alert.item }}
                                {% elif alert.type == 'expiring' %}
                                    ‚è∞ Expiring: {{ alert.item }} ({{ alert.days_left }} days)
                                {% endif %}
                            </div>
                            <div class="alert-description">
                                {% if alert.type == 'low_stock' %}
                                    Current: {{ alert.current }} | Required: {{ alert.required }}
                                {% elif alert.type == 'expiring' %}
                                    Location: {{ alert.location }} | Batch: {{ alert.batch }}
                                {% endif %}
                            </div>
                        </div>
                    {% endfor %}
                {% else %}
                    <div class="alert alert-success">
                        ‚úÖ No critical alerts at this time
                    </div>
                {% endif %}
            </div>
        </div>
        
        <!-- Recent Transactions -->
        <div class="col-lg-6 mb-4">
            <h3>üìã Recent Transactions</h3>
            <div class="transactions-section">
                {% if recent_transactions %}
                    {% for transaction in recent_transactions %}
                        <div class="transaction-item">
                            <div class="transaction-type {{ transaction.transaction_type }}">
                                {{ transaction.get_transaction_type_display }}
                            </div>
                            <div class="d-flex justify-content-between align-items-start">
                                <div>
                                    <strong>{{ transaction.item.name }}</strong>
                                    <br>
                                    <small class="text-muted">
                                        {{ transaction.quantity }} {{ transaction.item.unit }} 
                                        @ {{ transaction.location.name }}
                                    </small>
                                </div>
                                <div class="text-right">
                                    <small class="text-muted">
                                        {{ transaction.created_at|date:"H:i" }}
                                    </small>
                                    {% if transaction.created_by %}
                                        <br>
                                        <small>{{ transaction.created_by.get_full_name|default:transaction.created_by.username }}</small>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                {% else %}
                    <div class="alert alert-info">
                        üìù No recent transactions
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
